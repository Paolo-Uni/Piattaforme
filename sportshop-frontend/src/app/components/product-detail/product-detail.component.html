<div class="container mt-5">

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Caricamento in corso...</span>
    </div>
  </div>

  <div class="row" *ngIf="!isLoading && product">
    <div class="col-md-6 mb-4">
      <div class="card bg-light border-0 shadow-sm p-4 text-center">
        <img src="assets/scarpe.jpg"
             class="img-fluid rounded"
             style="max-height: 400px;"
             alt="{{product.nome}}">
      </div>
    </div>

    <div class="col-md-6">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb small">
          <li class="breadcrumb-item"><a routerLink="/prodotti">Catalogo</a></li>
          <li class="breadcrumb-item active">{{ product.categoria }}</li>
        </ol>
      </nav>

      <h1 class="h2 fw-bold">{{ product.nome }}</h1>
      <p class="text-muted h5">{{ product.marca }}</p>

      <div class="my-4">
        <h3 class="text-primary fw-bold">€ {{ product.prezzo | number:'1.2-2' }}</h3>
      </div>

      <p class="text-secondary">{{ product.descrizione }}</p>

      <div class="card bg-light border-0 p-3 my-4">
        <div class="row">
          <div class="col-6">
            <span class="small text-muted d-block">Colore</span>
            <strong>{{ product.colore }}</strong>
          </div>
          <div class="col-6">
            <span class="small text-muted d-block">Taglia</span>
            <strong>{{ product.taglia }}</strong>
          </div>
        </div>
        <hr>
        <div class="small">
          <strong>Disponibilità:</strong>
          <span [ngClass]="product.stock > 0 ? 'text-success' : 'text-danger'">
                {{ product.stock > 0 ? product.stock + ' pezzi pronti per la spedizione' : 'Attualmente non disponibile' }}
            </span>
        </div>
      </div>

      <div *ngIf="message" class="alert mb-3" [ngClass]="isError ? 'alert-danger' : 'alert-success'">
        {{ message }}
      </div>

      <div class="d-flex gap-3 align-items-center" *ngIf="product.stock > 0">
        <div style="width: 100px;">
          <input type="number" class="form-control" [(ngModel)]="quantity" min="1" [max]="product.stock">
        </div>
        <button class="btn btn-primary btn-lg flex-grow-1" (click)="addToCart()">
          <i class="bi bi-cart-plus me-2"></i> Aggiungi al Carrello
        </button>
      </div>

      <div *ngIf="product.stock === 0" class="mt-3">
        <button class="btn btn-secondary btn-lg w-100" disabled>Esaurito</button>
      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && isError" class="alert alert-warning text-center mt-4">
    <h4 class="alert-heading">Attenzione</h4>
    <p>{{ message }}</p>
    <hr>
    <a routerLink="/prodotti" class="btn btn-primary">Torna allo Shop</a>
  </div>

</div>
