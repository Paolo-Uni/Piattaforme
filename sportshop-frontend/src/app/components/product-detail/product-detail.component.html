<div class="container mt-5">

  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Caricamento...</span>
    </div>
    <p class="mt-2">Caricamento dettagli prodotto...</p>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger text-center">
    {{ errorMessage }}
    <div class="mt-3">
      <a routerLink="/prodotti" class="btn btn-outline-secondary">Torna ai prodotti</a>
    </div>
  </div>

  <div *ngIf="!isLoading && !errorMessage && product" class="card shadow-sm">
    <div class="row g-0">
      <div class="col-md-5 bg-light d-flex align-items-center justify-content-center" style="min-height: 400px;">
        <i class="bi bi-image text-muted" style="font-size: 5rem;"></i>
      </div>

      <div class="col-md-7">
        <div class="card-body p-4">
          <div class="d-flex justify-content-between align-items-start">
            <h1 class="card-title fw-bold mb-0">{{ product.nome }}</h1>
            <span class="badge bg-secondary">{{ product.categoria }}</span>
          </div>

          <h4 class="text-muted mt-2">{{ product.marca }}</h4>
          <h3 class="text-primary mt-3">€ {{ product.prezzo | number:'1.2-2' }}</h3>

          <p class="card-text mt-4 lead">{{ product.descrizione }}</p>

          <div class="row mt-4">
            <div class="col-6">
              <strong>Colore:</strong> {{ product.colore }}
            </div>
            <div class="col-6">
              <strong>Taglia:</strong> {{ product.taglia }}
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-md-6">
              <strong>Disponibilità:</strong>
              <span [class.text-success]="product.stock > 0" [class.text-danger]="product.stock === 0">
                    {{ product.stock > 0 ? product.stock + ' pezzi disponibili' : 'Esaurito' }}
                </span>
            </div>
          </div>

          <hr class="my-4">

          <div class="d-flex align-items-center gap-3" *ngIf="product.stock > 0">
            <div class="input-group" style="width: 130px;">
              <span class="input-group-text">Qtà</span>
              <input type="number" class="form-control" [(ngModel)]="quantitaSelezionata" min="1" [max]="product.stock">
            </div>
            <button class="btn btn-success btn-lg flex-grow-1" (click)="aggiungiAlCarrello()">
              <i class="bi bi-cart-plus"></i> Aggiungi al Carrello
            </button>
          </div>

          <div *ngIf="product.stock === 0" class="alert alert-warning mt-3">
            Questo prodotto non è attualmente disponibile.
          </div>

        </div>
      </div>
    </div>

    <div class="card-footer bg-white border-top-0 p-3">
      <a routerLink="/prodotti" class="btn btn-link text-decoration-none">
        <i class="bi bi-arrow-left"></i> Torna alla lista
      </a>
    </div>
  </div>
</div>
