<div class="container mt-4">
  <h2>Il tuo Carrello</h2>
  <div *ngIf="cartItems.length === 0" class="alert alert-info">Il carrello è vuoto. <a routerLink="/prodotti">Vai allo shopping</a></div>

  <div *ngIf="cartItems.length > 0">
    <table class="table align-middle">
      <thead><tr><th>Prodotto</th><th>Prezzo</th><th>Qta</th><th>Totale</th><th>Azioni</th></tr></thead>
      <tbody>
      <tr *ngFor="let item of cartItems">
        <td>{{ item.nomeProdotto }} <br> <small class="text-muted">{{item.taglia}} - {{item.colore}}</small></td>
        <td>€ {{ item.prezzoUnitario | number:'1.2-2' }}</td>
        <td>
          <div class="btn-group btn-group-sm">
            <button class="btn btn-outline-secondary" (click)="decrementa(item.idProdotto)">-</button>
            <span class="btn btn-light disabled">{{ item.quantita }}</span>
            <button class="btn btn-outline-secondary" (click)="incrementa(item.idProdotto)">+</button>
          </div>
        </td>
        <td>€ {{ (item.prezzoUnitario * item.quantita) | number:'1.2-2' }}</td>
        <td><button class="btn btn-danger btn-sm" (click)="rimuovi(item.idProdotto)"><i class="bi bi-trash"></i></button></td>
      </tr>
      </tbody>
    </table>

    <div class="row justify-content-end mt-4">
      <div class="col-md-4">
        <div class="card p-3">
          <h4>Totale: € {{ totale | number:'1.2-2' }}</h4>
          <div class="mb-3">
            <label>Indirizzo di Spedizione:</label>
            <input type="text" class="form-control" [(ngModel)]="indirizzoSpedizione" placeholder="Via Roma 1, Milano">
          </div>
          <button class="btn btn-success w-100" (click)="checkout()">Concludi Ordine</button>
          <div *ngIf="errore" class="text-danger mt-2">{{ errore }}</div>
          <div *ngIf="messaggio" class="text-success mt-2">{{ messaggio }}</div>
        </div>
      </div>
    </div>
  </div>
</div>
